# ERP 기능 테스트 가이드

이 문서는 최근 구현된 ERP 시스템의 새로운 기능들을 테스트하고 확인하는 방법을 설명합니다.

## 1. 사용자 팀 할당 (User Team Management)

관리자가 사용자를 생성하거나 수정할 때 소속 팀을 지정할 수 있습니다.

**확인 방법:**
1. 관리자 계정으로 로그인합니다.
2. 메뉴에서 **사용자 관리** (`/admin/users`) 페이지로 이동합니다.
3. 사용자 목록 테이블에 **'팀'** 컬럼이 추가되었는지 확인합니다.
4. **[사용자 추가]** 버튼을 클릭하거나 기존 사용자의 **[수정]** 버튼을 클릭합니다.
5. 입력 폼에 **'팀 (선택)'** 드롭다운 메뉴가 있는지 확인합니다.
6. 팀(예: `생산팀`, `도면팀`)을 선택하고 저장합니다.
7. 사용자 목록에서 해당 사용자의 팀이 올바르게 표시되는지 확인합니다.

---

## 2. 도면 전달 (Drawing Transfer)

도면팀이 도면 작업을 마치고 다음 단계(고객 컨펌/확정 대기)로 넘기는 기능입니다.

**확인 방법:**
1. **ERP 대시보드** (`/erp/dashboard`)로 이동합니다.
2. 프로세스 맵(상단 파이프라인)에서 **'도면'** 단계를 클릭하여 도면 단계의 주문만 필터링합니다.
   - *만약 도면 단계의 주문이 없다면, 새 주문을 생성하고 단계를 '도면'까지 진행시켜야 합니다.*
3. 목록에서 주문을 클릭하여 **상세 정보** 패널을 엽니다.
4. 상세 정보 하단에 **[도면 전달]** 버튼(파란색)이 있는지 확인합니다.
   - *주의: 이 버튼은 주문 상태가 '도면(DRAWING)'일 때만 나타납니다.*
5. **[도면 전달]** 버튼을 클릭합니다.
6. 팝업창에 **전달 메모**를 입력하고 확인을 누릅니다.
7. 처리가 완료되면 페이지가 새로고침되고, 해당 주문의 상태가 **'고객컨펌'** (또는 확정대기)으로 변경되었는지 확인합니다.

---

## 3. 생산 대시보드 및 프로세스 (Production Dashboard)

생산팀이 주문을 접수(제작 시작)하고 완료(출고 대기) 처리하는 전용 대시보드입니다.

**확인 방법:**
1. ERP 대시보드 상단 서브 메뉴에서 **[생산]** 탭을 클릭하여 `/erp/production/dashboard`로 이동합니다.
2. **대시보드 화면 확인**: '생산 대시보드'라는 타이틀과 함께 생산 관련 파이프라인(고객컨펌 -> 생산 -> 시공)이 보여야 합니다.

**[시나리오 A: 제작 시작]**
1. **'고객컨펌'** (제작 대기) 상태인 주문을 찾습니다. (위에서 '도면 전달'을 완료한 주문이 여기 있어야 합니다.)
2. 해당 주문을 클릭하여 상세 정보를 엽니다.
3. 상세 정보 영역 또는 액션 영역에 **[제작 시작]** 버튼이 있는지 확인합니다.
   - *메시지: "도면 및 주문 사항을 확인하고 제작을 시작하세요."*
4. **[제작 시작]** 버튼을 클릭하고 확인합니다.
5. 주문 상태가 **'생산'** (제작 중)으로 변경됩니다.

**[시나리오 B: 제작 완료]**
1. **'생산'** (제작 중) 상태인 주문을 찾습니다.
2. 상세 정보를 열고 **[제작 완료]** 버튼이 있는지 확인합니다.
   - *메시지: "제작이 완료되면 출고 대기 상태로 변경하세요."*
3. **[제작 완료]** 버튼을 클릭하고 확인합니다.
4. 주문 상태가 **'시공'** (출고/시공 대기)으로 변경되며, 생산 대시보드의 '생산' 리스트에서 사라집니다 (또는 '시공' 탭으로 이동).

---

## 4. 로그 및 데이터 확인 (Data Verification)

각 단계별 상태 변경과 로그가 데이터베이스에 올바르게 저장되었는지 확인합니다.

**확인 방법 (API):**
1. 브라우저 주소창에 다음 URL을 입력하여 해당 주문의 원본 데이터(JSON)를 확인합니다.
   - `http://localhost:5000/api/orders/<주문ID>/structured`
   - (`<주문ID>`는 테스트한 주문의 번호입니다.)
2. JSON 데이터 내의 `workflow` 객체를 찾습니다.
3. `workflow.stage` 값이 현재 상태(예: `PRODUCTION`, `CONSTRUCTION`)와 일치하는지 확인합니다.
4. `workflow.history` 배열을 확인합니다. 아래와 같은 로그가 쌓여 있어야 합니다.
   - `stage`: "PRODUCTION", `note`: "제작 시작"
   - `stage`: "CONSTRUCTION", `note`: "제작 완료 (시공/출고 대기)"

**예시 데이터:**
```json
{
  "workflow": {
    "stage": "CONSTRUCTION",
    "history": [
      {
        "stage": "PRODUCTION",
        "updated_at": "2024-05-20T10:00:00",
        "note": "제작 시작"
      },
      {
        "stage": "CONSTRUCTION",
        "updated_at": "2024-05-20T14:30:00",
        "note": "제작 완료 (시공/출고 대기)"
      }
    ]
  }
}
```
